## 基础知识

### 公钥和私钥

1.每个用户都有一对私钥和公钥。

- 私钥用来进行解密和签名，是给自己用的。
- 公钥由本人公开，用于加密和验证签名，是给别人用的。

问：如何安全的传输数据，不让第三方窃取？

 **当该用户接受文件时，别人用他的公钥加密，他用私钥解密，可以保证该信息只能由他看到。即安全传输。**

问：如何确保接收到的文件是对方发的？

 **当该用户发送文件时，用私钥签名，别人用他给的公钥解密，可以保证该信息是由他发送的。即数字签名。**



## 安全方向

### 多方安全计算:

#### **1、秘密共享**

​	秘密共享的思想是将秘密以适当的方式拆分，拆分后的每一个份额由不同的参与者管理，单个参与者无法恢复秘密信息，只有若干个参与者一同协作才能恢复秘密消息。更重要的是，当其中任何相应范围内参与者出问题时，秘密仍可以完整恢复。

https://www.zhihu.com/search?type=content&q=%E7%A7%98%E5%AF%86%E5%85%B1%E4%BA%AB

#### **2、不经意传输**

#### **3、零知识证明**

​	零知识证明指的是证明者能够在不向验证者提供任何有用信息的情况下，使验证者相信某个论断是正确的。允许证明者 prover、验证者 verifier 证明某项提议的真实，却不必泄露除了「提议是真实的」之外的任何信息。

#### **4、混淆电路**



### 同态加密:

​	同态加密（HE，homomorphic encryption）是一种允许在加密之后的密文上直接进行计算，且计算结果解密后和明文的计算结果一致的加密算法。

<img src="https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202209201439765.png" alt="image-20220920143925687" style="zoom: 33%;" /> 		

​	满足该式子代表是符合同态加密。⭐号表示其中一种运算（目前主要支持加法/乘法）



#### 分类：

（按照算法支持的运算类型和数量）

##### 1.部分同态加密（PHE，Partial HE）

​	指同态加密只对加法或乘法（其中一种）有同态性质。

<img src="https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202209201445803.png" alt="image-20220920144557760" style="zoom: 80%;" />

​	优点：原理简单，易实现。

​	缺点：仅支持一种运算

**经典算法：**

RSA算法和ElGamal算法为代表的**乘法同态加密**。

Paillier算法为代表的**加法同态加密**。

Boneh-Goh-Nissim方案为代表的**有限次数全同态加密**。

<img src="https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202209201648146.jpeg" alt="preload"  />

###### Paillier算法详解：

四个步骤：

​	密钥生成(公钥+私钥)

​	加密（用公钥），需要Encrtpt()加密函数

​	解密（用密钥），需要Decrypt ()解密函数

**1.密钥生成**

- gcd表示最大公因(约)数，lcm表示最小共倍数
- 长度相等：表示绝对值相同。
- Z*代表整数，且为正的。

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e069e6d3c9ff42508fcac30536039cc8~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="img" style="zoom: 80%;" />

**2.加密**

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/93c387f834ed44a19330e2789dbd0abc~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="img" style="zoom:80%;" />

**3.解密**

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0cc37c0c87b4445189675c3c509d8a67~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="img" style="zoom:80%;" />

**同态加**

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/103a88e3508b480eab2ecfe65011f428~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="img" style="zoom:80%;" />

**同态标量乘**

<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/125275f78db14db4a0dc824329861a84~tplv-k3u1fbpfcp-zoom-in-crop-mark:3024:0:0:0.awebp" alt="img" style="zoom:80%;" />

原理详解：https://wdxtub.com/flt/flt-03/2020/12/02/

###### Paillier算法实现(Pyhton)：

```python
if __name__ == "__main__":
    #直接使用paillier函数生成密钥
    public_key, private_key = paillier.generate_paillier_keypair(n_length=10)
    print('pub', public_key.g, public_key.n)
    print('priv', private_key.p, private_key.q)
    A=[3,32]
    print('A', A)
    #公钥加密
    enA=[public_key.encrypt(x) for x in A]
    print(enA[0].ciphertext(False))
    print(enA[0].ciphertext(False).bit_length())
    B=[4,16]
    print('B', B)
    #公钥加密
    enB=[public_key.encrypt(x) for x in B]
    print(enB[0].ciphertext(False))
    print(enB[0].ciphertext(False).bit_length())
    #执行同态运算
    en=np.add(enA,enB)
    print(en[0].ciphertext(False))
    print(en[0].ciphertext(False).bit_length())
    #解密输出
    for x in en:
        print(private_key.decrypt(x))
```

###### Paillier算法在联邦学习应用：

下面模型采用：差分隐私加噪 + 同态加密

![image-20220925181846240](C:/Users/10275/AppData/Roaming/Typora/typora-user-images/image-20220925181846240.png)

本地梯度上传给服务器之前公钥加密，服务器聚合后的梯度发回给客户端，客户端私钥解密全局梯度。（全体客户端要使用同一套密钥）

- 恶意客户端不断参与训练，通过他人梯度g携带的信息，从而获取其他客户端信息。
- 公钥私钥又第三方来发，既不是服务器也不是客户端。（服务器也不知道加密后的数据，也防止了梯度传输过程中的泄露）



##### 2.全同态加密（FHE，Fully HE）

支持在密文上进行无限次数，任意类型的计算。

缺点：效率很低，目前还无法支撑大规模的计算。

**经典算法：**

Gentry方案为代表的第一代方案、以BGV方案和BFV方案为代表的第二代方案、GSW方案为代表的第三代方案。

支持浮点数近似计算的CKKS方案。

![preload](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202209201648473.jpeg)



### **差分隐私**:

​	主要是通过使用随机噪声来确保，查询请求公开可见信息的结果，并不会泄露个体的隐私信息，即提供一种当从统计数据库查询时，最大化数据查询的准确性，同时最大限度减少识别其记录的机会，简单来说，就是保留统计学特征的前提下去除个体特征以保护用户隐私。

#### 1.本地差分隐私

#### 2.分布式差分隐私

#### 3.安全聚合 

#### 4.安全洗牌

#### 5.混合差分隐私

## 联邦学习隐私保护

前提：梯度可以逆推出原始数据（通过随机生成数据一同参与训练，训练多次后结果）



一般使用同态加密算法PHE，多见为加法。（因为联邦学习中，需对中间梯度结果进行聚合）

论文：Secure federated matrix factorization









## Q1杨强综述

2. 联邦学习
   - 2.1 联邦学习的定义
   - 2.2 联邦学习的隐私
   - 2.3 联邦学习的分类
     - 2.3.1 横向联邦学习
     - 2.3.2 纵向联邦学习
     - 2.3.3 联邦迁移学习
   - 2.4 联邦学习系统的架构
     - 2.4.1 **横向联邦学习**的架构
     - 2.4.2 **纵向联邦学习**的架构
     - 2.4.3 **联邦迁移学习**的架构
     - 2.4.4 激励机制







