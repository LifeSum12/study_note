##  函数（select）

### 统计函数

##### Count 统计记录数量

![image-20220728165946022](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202207281659082.png)

两种方式：count(*) 和 count(列) 的区别

1. count(*) 返回满足条件的**记录行数**。

2. count(列)统计满足条件的某列有多少个，并且会排除null值。



##### SUM 一列数据的和

![image-20220728170322696](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202207281703748.png)

（一般使用在数值列）

```mysql
-- 统计一个班级数学总成绩
SELECT SUM(math) FROM student; 
```



##### Avg 一列数据平均值

![image-20220728170458609](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202207281704663.png)

```mysql
-- 求一个班级数学平均分
SELECT AVG(math) FROM student;
```



##### Max/min  一列数据最值

![image-20220728170511400](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202207281705447.png)

```mysql
-- 求班级最高分和最低分（数值范围在统计中特别有用）
SELECT MAX(math + english + chinese), MIN(math + english + chinese)	FROM student;
```



##### 分组统计

①使用 group by 子句对列进行分组

![image-20220728170552113](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202207281705177.png)

```mysql
#每个部门的平均工资
SELECT AVG(salary),deptno,job FROM emp
	GROUP BY deptno;
#每个部门的每种岗位的平均工资（先按部门分，再按岗位分）
SELECT AVG(salary),deptno,job FROM emp
	GROUP BY deptno,job; 
/*显示查询结果
AVG(salary)	deptno	job
11000		1	work
10000		2	manager
20000		2	work
9000		3	manager
4000		3	work
*/
```

②使用 having 子句对分组后的结果进行过滤

![image-20220728170603041](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202207281706089.png)

```mysql
#显示平均工资低于2000的部门号和它的平均工资
SELECT deptno,AVG(salary)  FROM emp
	GROUP BY deptno
	HAVING AVG(salary)<10000
/*使用别名效率更高*/
```



### 字符串函数

![image-20220728173816311](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202207281738459.png)

#### 具体使用：

```mysql
-- CHARSET(str) 返回字串字符集
SELECT CHARSET(ename) FROM emp; 

-- CONCAT (string2 [,... ]) 连接字串, 将多个列拼接成一列
SELECT CONCAT(ename, ' 工作是 ', job) FROM emp; 

-- INSTR (string ,substring ) 返回 substring 在 string 中出现的位置,没有返回 0
-- dual 亚元表, 系统表 可以作为测试表使用
SELECT INSTR('hanshunping', 'ping') FROM DUAL;

-- UCASE (string2 ) 把查询到的数据，转换成大写
SELECT UCASE(ename) FROM emp; 

-- LCASE (string2 ) 把查询到的数据，转换成小写
SELECT LCASE(ename) FROM emp;

-- LEFT (string2 ,length )从 string2 中的左边起取 length 个字符
-- RIGHT (string2 ,length ) 从 string2 中的右边起取 length 个字符
SELECT LEFT(ename, 2) FROM emp; 

-- LENGTH (string) string 长度[按照字节]
SELECT LENGTH(ename) FROM emp; 

-- REPLACE (str ,search_str ,replace_str )
-- 在 str 中用 replace_str 替换 search_str
-- 如果是 manager 就替换成 经理
SELECT ename, REPLACE(job,'MANAGER', '经理') FROM emp;

-- STRCMP (string1 ,string2 ) 逐字符比较两字串大小。返回值为1，0，-1
SELECT STRCMP('hsp', 'hsp') FROM DUAL; 

-- SUBSTRING (str , position [,length ]) 子串
-- 从 str 的 position 开始【从 1 开始计算】,取 length 个字符
-- 从 ename 列的第一个位置开始取出 2 个字符
SELECT SUBSTRING(ename, 1, 2) FROM emp; 

-- LTRIM (string2 ) RTRIM (string2 ) 去除前端空格或后端空格
-- TRIM(string) 去除前端空格和后端空格
SELECT LTRIM(' 韩顺平教育') FROM DUAL;
SELECT RTRIM('韩顺平教育 ') FROM DUAL;
SELECT TRIM(' 韩顺平教育 ') FROM DUAL;
```



### 数学函数 

![image-20220728180034322](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202207281800423.png)
#### 具体使用

```mysql
-- ABS(num) 绝对值
SELECT ABS(-10) FROM DUAL; 

-- BIN (decimal_number )十进制转二进制
SELECT BIN(10) FROM DUAL; 

-- CEILING (number2 ) 向上取整, 得到比 num2 大的最小整数
SELECT CEILING(-1.1) FROM DUAL; 

-- CONV(number2,from_base,to_base) 进制转换
-- 下面的含义是 8 是十进制的 8, 转成 2 进制输出
SELECT CONV(8, 10, 2) FROM DUAL; 
-- 下面的含义是 8 是 16 进制的 8, 转成 2 进制输出
SELECT CONV(16, 16, 10) FROM DUAL; 

-- FLOOR (number2 ) 向下取整,得到比 num2 小的最大整数
SELECT FLOOR(-1.1) FROM DUAL; 

-- FORMAT (number,decimal_places ) 保留小数位数(四舍五入)
SELECT FORMAT(78.125458,2) FROM DUAL; 

-- HEX (DecimalNumber ) 转十六进制

-- LEAST (number , number2 [,..]) 求最小值
SELECT LEAST(0,1, -10, 4) FROM DUAL; 

-- MOD (numerator ,denominator ) 求余
SELECT MOD(10, 3) FROM DUAL; 

-- RAND([seed]) RAND([seed]) 返回随机数 其范围为 0 ≤ v ≤ 1.0
-- 老韩说明
-- 1. 如果使用 rand() 每次返回不同的随机数 ，在 0 ≤ v ≤ 1.0
-- 2. 如果使用 rand(seed) 返回随机数, 范围 0 ≤ v ≤ 1.0, 如果 seed 不变，
-- 该随机数也不变了
SELECT RAND() FROM DUAL;
```





### 时间日期（未细看视频学）

![image-20220728180534025](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202207281805152.png)

date返回日期（年几月几号）

time返回时间（几时几分）

时间戳返回全部（年月日时分秒）

 

### 加密和系统函数

![image-20220728180609329](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202207281806450.png)

#### 具体使用：

略。



### 流程控制函数

![image-20220728180810432](https://raw.githubusercontent.com/LifeSum12/typora-image/main/img/202207281808538.png)

#### 具体使用：

判断参数是否为空用关键字is，如：comm is null

```mysql
# IF(expr1,expr2,expr3) 如果 expr1 为 True ,则返回 expr2 否则返回 expr3
SELECT IF(TRUE, '北京', '上海') FROM DUAL;

# IFNULL(expr1,expr2) 如果 expr1 不为空 NULL,则返回 expr1,否则返回 expr2
SELECT IFNULL( NULL, '韩顺平教育') FROM DUAL;

# SELECT CASE WHEN expr1 THEN expr2 WHEN expr3 THEN expr4 ELSE expr5 END; [类似多重分支.]
# 如果 expr1 为 TRUE,则返回 expr2,如果 expr2 为 t, 返回 expr4, 否则返回 expr5
SELECT CASE
	WHEN TRUE THEN 'jack' -- jack
	WHEN FALSE THEN 'tom'
	ELSE 'mary' END
```



 
